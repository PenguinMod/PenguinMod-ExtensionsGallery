// Bundled with webpack, repo at https://github.com/lego7set/PenguinScript.
// Version 1.1.1
// Expect this thingy to have a lot of bugs.
/*!
    MIT License
    
    Copyright (c) 2024 lego7set
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
*/
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,(()=>(()=>{var __webpack_modules__={716:function(e,t){var r;!function(n){"use strict";var o=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},s=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},i=function(){throw SyntaxError("Invalid Param")};function a(e,t){var r=Math.abs(e),n=Math.abs(t);return 0===e?Math.log(n):0===t?Math.log(r):r<3e3&&n<3e3?.5*Math.log(e*e+t*t):(e/=2,t/=2,.5*Math.log(e*e+t*t)+Math.LN2)}function p(e,t){if(!(this instanceof p))return new p(e,t);var r=function(e,t){var r={re:0,im:0};if(null==e)r.re=r.im=0;else if(void 0!==t)r.re=e,r.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)r.re=e.re,r.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return p.INFINITY;r.re=e.abs*Math.cos(e.arg),r.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return p.INFINITY;r.re=e.r*Math.cos(e.phi),r.im=e.r*Math.sin(e.phi)}else 2===e.length?(r.re=e[0],r.im=e[1]):i();break;case"string":r.im=r.re=0;var n=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),o=1,s=0;null===n&&i();for(var a=0;a<n.length;a++){var u=n[a];" "===u||"\t"===u||"\n"===u||("+"===u?o++:"-"===u?s++:"i"===u||"I"===u?(o+s===0&&i()," "===n[a+1]||isNaN(n[a+1])?r.im+=parseFloat((s%2?"-":"")+"1"):(r.im+=parseFloat((s%2?"-":"")+n[a+1]),a++),o=s=0):((o+s===0||isNaN(u))&&i(),"i"===n[a+1]||"I"===n[a+1]?(r.im+=parseFloat((s%2?"-":"")+u),a++):r.re+=parseFloat((s%2?"-":"")+u),o=s=0))}o+s>0&&i();break;case"number":r.im=0,r.re=e;break;default:i()}return isNaN(r.re)||isNaN(r.im),r}(e,t);this.re=r.re,this.im=r.im}p.prototype={re:0,im:0,sign:function(){var e=this.abs();return new p(this.re/e,this.im/e)},add:function(e,t){var r=new p(e,t);return this.isInfinite()&&r.isInfinite()?p.NAN:this.isInfinite()||r.isInfinite()?p.INFINITY:new p(this.re+r.re,this.im+r.im)},sub:function(e,t){var r=new p(e,t);return this.isInfinite()&&r.isInfinite()?p.NAN:this.isInfinite()||r.isInfinite()?p.INFINITY:new p(this.re-r.re,this.im-r.im)},mul:function(e,t){var r=new p(e,t);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?p.NAN:this.isInfinite()||r.isInfinite()?p.INFINITY:0===r.im&&0===this.im?new p(this.re*r.re,0):new p(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(e,t){var r=new p(e,t);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return p.NAN;if(this.isInfinite()||r.isZero())return p.INFINITY;if(this.isZero()||r.isInfinite())return p.ZERO;e=this.re,t=this.im;var n,o,s=r.re,i=r.im;return 0===i?new p(e/s,t/s):Math.abs(s)<Math.abs(i)?new p((e*(o=s/i)+t)/(n=s*o+i),(t*o-e)/n):new p((e+t*(o=i/s))/(n=i*o+s),(t-e*o)/n)},pow:function(e,t){var r=new p(e,t);if(e=this.re,t=this.im,r.isZero())return p.ONE;if(0===r.im){if(0===t&&e>0)return new p(Math.pow(e,r.re),0);if(0===e)switch((r.re%4+4)%4){case 0:return new p(Math.pow(t,r.re),0);case 1:return new p(0,Math.pow(t,r.re));case 2:return new p(-Math.pow(t,r.re),0);case 3:return new p(0,-Math.pow(t,r.re))}}if(0===e&&0===t&&r.re>0&&r.im>=0)return p.ZERO;var n=Math.atan2(t,e),o=a(e,t);return e=Math.exp(r.re*o-r.im*n),t=r.im*o+r.re*n,new p(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e,t,r=this.re,n=this.im,o=this.abs();if(r>=0){if(0===n)return new p(Math.sqrt(r),0);e=.5*Math.sqrt(2*(o+r))}else e=Math.abs(n)/Math.sqrt(2*(o-r));return t=r<=0?.5*Math.sqrt(2*(o-r)):Math.abs(n)/Math.sqrt(2*(o+r)),new p(e,n<0?-t:t)},exp:function(){var e=Math.exp(this.re);return this.im,new p(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new p(Math.expm1(e)*Math.cos(t)+function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var r=e*e;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return new p(a(e,t),Math.atan2(t,e))},abs:function(){return e=this.re,t=this.im,r=Math.abs(e),n=Math.abs(t),r<3e3&&n<3e3?Math.sqrt(r*r+n*n):(r<n?(r=n,n=e/t):n=t/e,r*Math.sqrt(1+n*n));var e,t,r,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new p(Math.sin(e)*o(t),Math.cos(e)*s(t))},cos:function(){var e=this.re,t=this.im;return new p(Math.cos(e)*o(t),-Math.sin(e)*s(t))},tan:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)+o(t);return new p(Math.sin(e)/r,s(t)/r)},cot:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)-o(t);return new p(-Math.sin(e)/r,s(t)/r)},sec:function(){var e=this.re,t=this.im,r=.5*o(2*t)+.5*Math.cos(2*e);return new p(Math.cos(e)*o(t)/r,Math.sin(e)*s(t)/r)},csc:function(){var e=this.re,t=this.im,r=.5*o(2*t)-.5*Math.cos(2*e);return new p(Math.sin(e)*o(t)/r,-Math.cos(e)*s(t)/r)},asin:function(){var e=this.re,t=this.im,r=new p(t*t-e*e+1,-2*e*t).sqrt(),n=new p(r.re-t,r.im+e).log();return new p(n.im,-n.re)},acos:function(){var e=this.re,t=this.im,r=new p(t*t-e*e+1,-2*e*t).sqrt(),n=new p(r.re-t,r.im+e).log();return new p(Math.PI/2-n.im,n.re)},atan:function(){var e=this.re,t=this.im;if(0===e){if(1===t)return new p(0,1/0);if(-1===t)return new p(0,-1/0)}var r=e*e+(1-t)*(1-t),n=new p((1-t*t-e*e)/r,-2*e/r).log();return new p(-.5*n.im,.5*n.re)},acot:function(){var e=this.re,t=this.im;if(0===t)return new p(Math.atan2(1,e),0);var r=e*e+t*t;return 0!==r?new p(e/r,-t/r).atan():new p(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new p(0,1/0);var r=e*e+t*t;return 0!==r?new p(e/r,-t/r).acos():new p(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new p(Math.PI/2,1/0);var r=e*e+t*t;return 0!==r?new p(e/r,-t/r).asin():new p(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new p(s(e)*Math.cos(t),o(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new p(o(e)*Math.cos(t),s(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,r=o(e)+Math.cos(t);return new p(s(e)/r,Math.sin(t)/r)},coth:function(){var e=2*this.re,t=2*this.im,r=o(e)-Math.cos(t);return new p(s(e)/r,-Math.sin(t)/r)},csch:function(){var e=this.re,t=this.im,r=Math.cos(2*t)-o(2*e);return new p(-2*s(e)*Math.cos(t)/r,2*o(e)*Math.sin(t)/r)},sech:function(){var e=this.re,t=this.im,r=Math.cos(2*t)+o(2*e);return new p(2*o(e)*Math.cos(t)/r,-2*s(e)*Math.sin(t)/r)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else t=e.im,e.im=-e.re,e.re=t;return e},atanh:function(){var e=this.re,t=this.im,r=e>1&&0===t,n=1-e,o=1+e,s=n*n+t*t,i=0!==s?new p((o*n-t*t)/s,(t*n+o*t)/s):new p(-1!==e?e/0:0,0!==t?t/0:0),u=i.re;return i.re=a(i.re,i.im)/2,i.im=Math.atan2(i.im,u)/2,r&&(i.im=-i.im),i},acoth:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new p(0,Math.PI/2);var r=e*e+t*t;return 0!==r?new p(e/r,-t/r).atanh():new p(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(0===t)return new p(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var r=e*e+t*t;return 0!==r?new p(e/r,-t/r).asinh():new p(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return p.INFINITY;var r=e*e+t*t;return 0!==r?new p(e/r,-t/r).acosh():new p(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return p.INFINITY;if(this.isInfinite())return p.ZERO;var e=this.re,t=this.im,r=e*e+t*t;return new p(e/r,-t/r)},conjugate:function(){return new p(this.re,-this.im)},neg:function(){return new p(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new p(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new p(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new p(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var r=new p(e,t);return Math.abs(r.re-this.re)<=p.EPSILON&&Math.abs(r.im-this.im)<=p.EPSILON},clone:function(){return new p(this.re,this.im)},toString:function(){var e=this.re,t=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<p.EPSILON&&(e=0),Math.abs(t)<p.EPSILON&&(t=0),0===t?r+e:(0!==e?(r+=e,r+=" ",t<0?(t=-t,r+="-"):r+="+",r+=" "):t<0&&(t=-t,r+="-"),1!==t&&(r+=t),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},p.ZERO=new p(0,0),p.ONE=new p(1,0),p.I=new p(0,1),p.PI=new p(Math.PI,0),p.E=new p(Math.E,0),p.INFINITY=new p(1/0,1/0),p.NAN=new p(NaN,NaN),p.EPSILON=1e-15,void 0===(r=function(){return p}.apply(t,[]))||(e.exports=r)}()},156:(module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const parser_1=__webpack_require__(56),lexer_1=__webpack_require__(345),jsGen_1=__webpack_require__(134),ComplexConstructor=__webpack_require__(716),Complex=ComplexConstructor;function transpile(e,t,r){const n=new parser_1.default(e).produceAST();return new jsGen_1.default(n).transpile("generator",!0,t,r)}function*createObjectStruct(e,...t){if(t.length%2!=0)throw new TypeError("Each key must have a value in object structs");const r=[];for(let e=0;e<t.length;e+=2)r.push([t[e],t[e+1]]);const n={__proto__:null,isStruct:!0,props:{__proto__:null},isObject:!0},o={__proto__:null,...Object.fromEntries(r)};return n.getActual=()=>o,n.toString=()=>"<PenguinScript Object>",n.props.get={value:function*(e,t){return o[t]}},n.props.set={value:function*(e,t,r){return o[t]=r}},n.props.has={value:function*(e,t){return null!=o[t]}},n.props.delete={value:function*(e,t){return delete o[t]}},n.props.remove={value:function*(e,t){return delete o[t],n}},n.props.append={value:function*(e,t,r){return o[t]=r,n}},n.props.fromJSON={value:function*(e,t){if("string"!=typeof t)throw new TypeError("Object.fromJSON must be passed a string");for(const e in o)Object.hasOwn(o,e)&&delete o[e];try{const e=JSON.parse(t);if("object"!=typeof e||!e||Array.isArray(e))throw new TypeError("Invalid JSON");Object.assign(o,e)}catch(e){throw new TypeError("Invalid JSON")}}},n.props.toJSON={value:function*(){return JSON.stringify(o)}},n}function*createArrayStruct(e,...t){const r={__proto__:null,isStruct:!0,props:{__proto__:null},isArray:!0},n=t;return r.getActual=()=>n,r.toString=()=>"<PenguinScript Array>",r.props.get={value:function*(e,t){if("number"!=typeof t)throw new TypeError("Key to array must be a number.");return t=Math.round(t)||0,n[t]}},r.props.set={value:function*(e,t,r){if("number"!=typeof t)throw new TypeError("Key to array must be a number.");return t=Math.round(t)||0,n[t]=r}},r.props.has={value:function*(e,t){if("number"!=typeof t)throw new TypeError("Key to array must be a number.");return(t=Math.round(t)||0)>=0&&t<n.length}},r.props.delete={value:function*(e,t){if("number"!=typeof t)throw new TypeError("Key to array must be a number.");return t=Math.round(t)||0,n.length=t}},r.props.pop={value:function*(){return n.pop()}},r.props.push={value:function*(e,t){return n.push(t),r}},r.props.shift={value:function*(){return n.shift()}},r.props.unshift={value:function*(e,t){return n.unshift(t),r}},r.props.length={get value(){return n.length},set value(e){if("number"!=typeof e)throw new TypeError("Cannot reassign to the length of an array with a non number");e=Math.round(e)||0,n.length=e}},r.props.fromJSON={value:function*(e,t){if("string"!=typeof t)throw new TypeError("Array.fromJSON must be passed a string");n.length=0;try{const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError("Invalid JSON");Object.assign(n,e)}catch(e){throw new TypeError("Invalid JSON")}}},r.props.toJSON={value:function*(){return JSON.stringify(n)}},r}function*log(e,...t){return console.log(...t),null}function*warn(e,...t){return console.warn(...t),null}function*error(e,...t){return console.error(...t),null}function*convertToString(e,t){return String(t)}function*convertToNumber(e,t){return Number(t)}function*convertToBoolean(e,t){return Boolean(t)}function*charFromCodePoint(e,t){return String.fromCodePoint(Number(t)||0)}function*charToCodePoint(e,t){if("string"!=typeof t)throw new TypeError("Please pass in a string to charToCodePoint");return t.codePointAt(0)??null}jsGen_1._globalEnv.__env.set("Object",{get value(){return createObjectStruct}}),jsGen_1._globalEnv.__env.set("Array",{get value(){return createArrayStruct}}),jsGen_1._globalEnv.__env.set("print",{get value(){return log}}),jsGen_1._globalEnv.__env.set("warn",{get value(){return warn}}),jsGen_1._globalEnv.__env.set("error",{get value(){return error}}),jsGen_1._globalEnv.__env.set("toString",{get value(){return convertToString}}),jsGen_1._globalEnv.__env.set("toNumber",{get value(){return convertToNumber}}),jsGen_1._globalEnv.__env.set("toBoolean",{get value(){return convertToBoolean}}),jsGen_1._globalEnv.__env.set("charFromCodePoint",{get value(){return charFromCodePoint}}),jsGen_1._globalEnv.__env.set("charToCodePoint",{get value(){return charToCodePoint}});const customObjectTypes={};function*type(e,t){if(null==t)return"null";if("object"==typeof t){for(const e in customObjectTypes)if(customObjectTypes[e](t))return e;return t.isStruct&&t.props?t.isError?"error":t.isObject?"object":t.isArray?"array":t.isComplex?"complex":"struct":"unknown"}return typeof t}function*exit(e,t){throw{isExit:!0,returnValue:t}}function*getRandomInt(e,t,r){return 1===arguments.length?0:(2===arguments.length?(r=Math.floor(Number(t)),t=0):(t=Math.floor(Number(t)),r=Math.floor(Number(r))),Object.is(t,NaN)||Object.is(r,NaN)?NaN:Object.is(t,r)?t:(t>r&&([t,r]=[r,t]),Math.floor(Math.random()*(r-t+1))+t))}function*createComplexStruct(e,t,r){let n;try{n=new Complex(t,r)}catch{throw new TypeError("Invalid arguments passed to Complex")}const o={__proto__:null,isStruct:!0,isComplex:!0,props:{__proto__:null}};let s=n.im,i=n.re;o.toString=()=>new Complex(o.props.re.value,o.props.im.value).toString(),o.props.re={get value(){return i},set value(e){if("number"!=typeof e)throw new TypeError("Can only set real or imaginary part of complex to a number.");i=e}},o.props.im={get value(){return s},set value(e){if("number"!=typeof e)throw new TypeError("Can only set real or imaginary part of complex to a number.");s=e}},o.props.__add__={value:function*(e,t){const r="number"==typeof t?new Complex(t):new Complex(t.props.re.value,t.props.im.value);return yield*createComplexStruct(e,new Complex(o.props.re.value,o.props.im.value).add(r))}},o.props.__subtract__={value:function*(e,t){const r="number"==typeof t?new Complex(t):new Complex(t.props.re.value,t.props.im.value);return yield*createComplexStruct(e,new Complex(o.props.re.value,o.props.im.value).sub(r))}},o.props.__multiply__={value:function*(e,t){const r="number"==typeof t?new Complex(t):new Complex(t.props.re.value,t.props.im.value);return yield*createComplexStruct(e,new Complex(o.props.re.value,o.props.im.value).mul(r))}},o.props.__divide__={value:function*(e,t){const r="number"==typeof t?new Complex(t):new Complex(t.props.re.value,t.props.im.value);return yield*createComplexStruct(e,new Complex(o.props.re.value,o.props.im.value).div(r))}},o.props.__power__={value:function*(e,t){const r="number"==typeof t?new Complex(t):new Complex(t.props.re.value,t.props.im.value);return yield*createComplexStruct(e,new Complex(o.props.re.value,o.props.im.value).pow(r))}};const a=function*(){throw new TypeError("Complex operation not implemented")};return o.props.__lt__={value:a},o.props.__gt__={value:a},o.props.__le__={value:a},o.props.__ge__={value:a},o.props.__mod__={value:a},o.props.__equals__={value:function*(e,t){const r="number"==typeof t?new Complex(t):t&&t.isComplex?new Complex(t.props.re.value,t.props.im.value):null;return null!==r&&new Complex(o.props.re.value,o.props.im.value).equals(r)}},o.props.__isCompatible__={value:function*(e,t){return t&&t.isComplex||"number"==typeof t}},o.props.arg={get value(){return Math.atan2(o.props.im.value,o.props.re.value)},set value(e){const t=new Complex({arg:e,abs:o.props.abs.value});o.props.re.value=t.re,o.props.im.value=t.im}},o.props.modulus={get value(){return Math.sqrt(o.props.re.value**2+o.props.im.value**2)},set value(e){const t=new Complex({arg:o.props.arg.value,abs:e});o.props.re.value=t.re,o.props.im.value=t.im}},o}function*getRandomFloat(e,t,r){return 1===arguments.length?(t=0,r=1):2===arguments.length?(r=Number(t),t=0):(t=Number(t),r=Number(r)),Object.is(t,NaN)||Object.is(r,NaN)?NaN:Object.is(t,r)?t:(t>r&&([t,r]=[r,t]),Math.random()*(r-t)+t)}jsGen_1._globalEnv.__env.set("typeof",{get value(){return type}}),jsGen_1._globalEnv.__env.set("exit",{get value(){return exit}}),Object.assign(createComplexStruct,{props:{fromArgModulus:{value:function*(e,t,r){const n=Complex({arg:t,abs:r});return yield*createComplexStruct(e,n.re,n.im)}}},isStruct:!0}),jsGen_1._globalEnv.__env.set("Complex",{get value(){return createComplexStruct}});const MathStruct=function(){const e={isStruct:!0,__proto__:null,isMath:!0,toString:()=>"<PenguinScript Math>"},t={__proto__:null,random:getRandomFloat,randomInt:getRandomInt,abs:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.abs(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).abs())},sign:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.sign(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).sign())},sqrt:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.sqrt(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).sqrt())},cbrt:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.cbrt(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).pow(1/3))},sin:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.sin(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).sin())},cos:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.cos(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).cos())},tan:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.tan(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).tan())},cot:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?1/Math.tan(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).cot())},sec:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?1/Math.cos(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).sec())},csc:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?1/Math.sin(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).csc())},pow:function*(e,t,r){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");if(!("number"==typeof r||r&&r.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");const n="number"==typeof t?t:new Complex(t.props.re.value,t.props.im.value),o="number"==typeof r?t:new Complex(r.props.re.value,r.props.im.value);return"number"==typeof t&&"number"==typeof r?Math.pow(t,r):yield*createComplexStruct(e,new Complex(0,0).add(n).pow(o))},asin:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.asin(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).asin())},acos:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.acos(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).acos())},atan:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.atan(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).atan())},acot:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.atan(1/t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).acot())},asec:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.acos(1/t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).asec())},acsc:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.asin(1/t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).acsc())},sinh:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.sinh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).sinh())},cosh:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.cosh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).cosh())},tanh:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.tanh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).tanh())},coth:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?1/Math.tanh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).coth())},sech:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?1/Math.cosh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).sech())},csch:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?1/Math.sinh(t):new Complex(t.props.re.value,t.props.im.value).csch()},asinh:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.asinh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).asinh())},acosh:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.acosh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).acosh())},atanh:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.atanh(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).atanh())},acoth:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.atanh(1/t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).acoth())},asech:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.acosh(1/t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).asech())},acsch:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.asinh(1/t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).acsch())},atan2:function*(e,t,r){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");if(!("number"==typeof r||r&&r.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");const n="number"==typeof t?t:new Complex(t.props.re.value,t.props.im.value),o="number"==typeof r?t:new Complex(r.props.re.value,r.props.im.value);return"number"==typeof t&&"number"==typeof r?Math.atan2(t,r):yield*createComplexStruct(e,new Complex(0,0).add(n).div(o).atan())},log:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.log(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).log())},log2:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.log2(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).log().div(new Complex(2).log()))},log10:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.log10(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).log().div(new Complex(10).log()))},exp:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.exp(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).exp())},expm1:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.expm1(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).expm1())},ceil:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.ceil(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).ceil(0))},floor:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.floor(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).floor(0))},round:function*(e,t){if(!("number"==typeof t||t&&t.isComplex))throw new TypeError("Math operations can only be used on complex and numbers");return"number"==typeof t?Math.round(t):yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).round(0))},arg:function*(e,t){if(!t||!t.isComplex)throw new TypeError("Arg can only be used on a complex number because it isn't useful for real numbers");return yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).arg())},conjugate:function*(e,t){if(!t||!t.isComplex)throw new TypeError("Conjugate can only be used on a complex");return yield*createComplexStruct(e,new Complex(t.props.re.value,t.props.im.value).conjugate())}};return e.props=new Proxy({__proto__:null},{get:(e,r)=>Object.hasOwn(t,r)?{get value(){return t[r]}}:Object.hasOwn(e,r)?{get value(){const t=e[r];return"function"==typeof t?function*(e,...r){return t(...r)}:t}}:{value:null}}),e}();function*join(e,t,r){return String(t)+String(r)}function*createMethod(e,t,r){if(!t.isStruct)throw new TypeError("You must pass in a struct to createMethod");if("function"!=typeof r)throw new TypeError("You must pass in a function to createMethod");return function*(e,...n){return yield*r(e,t,...n)}}function*createErrorStruct(e,t,r){if("string"==typeof t&&(t=new Error(t)),null===(t??null)&&(t=new Error("")),!(t instanceof Error))throw t;"string"==typeof r&&(t.name=r);const n={__proto__:null,isStruct:!0,isError:!0,props:{__proto__:null},toString:()=>"<PenguinScript Error>"};return n.props.msg={value:t.message||""},n.props.type={value:t.name||"Error"},n.props.throw={value:function*(){const e=new Error(n.props.msg.value);throw e.name=String(n.props.type.value),e}},n}function*deepClone(e,t){switch(yield*type(e,t)){case"error":{let r;try{yield*t.props.throw.value()}catch(e){r=e}return yield*createErrorStruct(e,r)}case"object":{const r=t.getActual(),n=yield*createObjectStruct(e);return Object.assign(n.getActual(),r),n}case"array":{const r=t.getActual(),n=yield*createArrayStruct(e);return Object.assign(n.getActual(),r),n}default:throw new TypeError("Can only deep clone errors, objects, and arrays.")}}function supportsNullishCoalescing(){try{return eval("true ?? 0")}catch(e){return!1}}jsGen_1._globalEnv.__env.set("math",{get value(){return MathStruct}}),jsGen_1._globalEnv.__env.set("join",{get value(){return join}}),jsGen_1._globalEnv.__env.set("concat",{get value(){return join}}),jsGen_1._globalEnv.__env.set("createMethod",{get value(){return createMethod}}),jsGen_1._globalEnv.__env.set("Error",{get value(){return createErrorStruct}}),jsGen_1._globalEnv.__env.set("deepClone",{get value(){return deepClone}});const canNullish=supportsNullishCoalescing();let Scratch;if("object"==typeof window&&window&&"object"==typeof window.document&&"object"==typeof(Scratch=window.Scratch)&&Scratch||"object"==typeof LoadedAsCore&&LoadedAsCore!==globalThis.LoadedAsCore&&(Scratch=LoadedAsCore)){if(!Scratch.extensions.isPenguinMod)throw"Please load PenguinScript in PenguinMod";function*e(e,t){if("string"!=typeof t)throw new TypeError("Attempted to get sprite with name, but name is not a string");return Scratch.vm.runtime.getSpriteTargetByName(t)}function*t(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set x position of non-sprite to "+Number(r));const n=Number(r)||0;return t.setXY(n,t.y,!1),null}function*r(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set y position of non-sprite to "+Number(r));const n=Number(r)||0;return t.setXY(t.x,n,!1),null}function*n(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set x and y position of non-sprite to "+Number(r)+"and "+Number(n)+" respectively");const o=Number(r)||0,s=Number(n)||0;return t.setXY(o,s,!1),null}function*o(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to change x position of non-sprite by "+Number(r));const n=Number(r)||0;return t.setXY(t.x+n,t.y,!1),null}function*s(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to change y position of non-sprite by "+Number(r));const n=Number(r)||0;return t.setXY(t.x,t.y+n,!1),null}function*i(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to change x and y position of non-sprite by "+Number(r)+"and "+Number(n)+" respectively");const o=Number(r)||0,s=Number(n)||0;return t.setXY(t.x+o,t.y+s,!1),null}function*a(e,t){return t*Math.PI/180}function*p(e,t){return 180*t/Math.PI}function u(e,t,r){if(!(e instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot move a non-sprite by "+Number(t)+" steps");Number(t);const n=r??e.direction,o=e.direction;e.setDirection(Number(n)||0);const s=e.direction;e.setDirection(o);const i=a(0,s).next().value,p=t*Math.cos(i),u=t*Math.sin(i);e.setXY(e.x+p,e.y+u)}function*c(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot set or change direction of a non-sprite");const n=Number(r)||0;return t.setDirection(n),null}function*l(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot set or change direction of a non-sprite");const n=Number(r)||0;return yield*c(0,t,t.direction+n)}function*h(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot set or change direction of a non-sprite");const n=Number(r)||0;return yield*c(0,t,t.direction-n)}function*m(e,t,r,n){return u(t,r,n),null}function*d(e,t,r,n){return u(t,0-(Number(r)||0),n),null}function*y(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot move up non-sprite by "+Number(r)+" steps");let o=n??t.direction;o=Number(o)||0;const s=Number(r)||0,i=t.direction;return t.setDirection(o-90),u(t,0-s),t.setDirection(i),null}function*f(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot move down non-sprite by "+Number(r)+" steps");let o=n??t.direction;o=Number(o)||0;const s=Number(r)||0,i=t.direction;return t.setDirection(o-90),u(t,s),t.setDirection(i),null}function*_(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get x position of non-sprite");return t.x}function*v(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get y position of non-sprite");return t.y}function*E(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get direction of non-sprite");return t.direction}function*T(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot make a non-sprite say something");const n=String(r);return Scratch.vm.runtime.emit("SAY",t,"say",n),null}function*b(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot make a non-sprite think something");const n=String(r);return Scratch.vm.runtime.emit("SAY",t,"think",n),null}function*g(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot set size of non-sprite");const n=Math.max(Number(r)||0,0);return t.setSize(n),null}function*w(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot set visibility of non-sprite");const n=!1===(r??!1);return t.setVisible(n),null}function*x(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get size of non-sprite");return t.size}function*N(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get visibility of non-sprite");return t.visible}function*S(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set x stretch of non-sprite to "+Number(r));const n=Number(r)||0;return t.setStretch(n,t.stretch[1]),null}function*C(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set y stretch of non-sprite to "+Number(r));const n=Number(r)||0;return t.setStretch(t.stretch[0],n),null}function*k(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set x and y stretch of non-sprite to "+Number(r)+"and "+Number(n)+" respectively");const o=Number(r)||0,s=Number(n)||0;return t.setStretch(o,s),null}function*O(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to change x stretch of non-sprite by "+Number(r));const n=Number(r)||0;return t.setXY(t.stretch[0]+n,t.stretch[1]),null}function*R(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to change y stretch of non-sprite by "+Number(r));const n=Number(r)||0;return t.setXY(t.stretch[0],t.stretch[1]+n),null}function*A(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to change x and y stretch of non-sprite by "+Number(r)+"and "+Number(n)+" respectively");const o=Number(r)||0,s=Number(n)||0;return t.setXY(t.stretch[0]+o,t.stretch[1]+s),null}function*M(e,t,r){if("string"!=typeof r&&"number"!=typeof r)throw new TypeError("Expected costume index to be a string or number");if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set costume of a non-sprite");const n=r;if("number"==typeof n)t.setCostume(n-1);else{const e=t.getCostumeIndexByName(n.toString());-1!==e?t.setCostume(e):isNaN(Number(n))||Scratch.Cast.isWhiteSpace(n)||t.setCostume(Number(n)-1)}return null}function*I(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set costume of a non-sprite");return t.setCostume(t.currentCostume+1),null}function*P(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set costume of a non-sprite");return t.setCostume(t.currentCostume-1),null}function*j(e,t){const r=Scratch.vm.runtime.getTargetForStage();if("string"!=typeof t&&"number"!=typeof t)throw new TypeError("Expected costume index to be a string or number");if(!(r instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set costume of a non-sprite");const n=t;if("number"==typeof n)r.setCostume(n-1);else{const e=r.getCostumeIndexByName(n.toString());-1!==e?r.setCostume(e):isNaN(Number(n))||Scratch.Cast.isWhiteSpace(n)||r.setCostume(Number(n)-1)}return null}function*B(){const e=Scratch.vm.runtime.getTargetForStage();if(!(e instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set costume of a non-sprite");return e.setCostume(e.currentCostume+1),null}function*L(){const e=Scratch.vm.runtime.getTargetForStage();if(!(e instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to set costume of a non-sprite");return e.setCostume(e.currentCostume-1),null}function*U(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to get current costume name of non-sprite");return t.getCostumes()[t.currentCostume].name}function*G(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to get current costume number of non-sprite");return t.currentCostume+1}function*$(){const e=Scratch.vm.runtime.getTargetForStage();if(!(e instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to get current costume name of non-sprite");return e.getCostumes()[e.currentCostume].name}function*Y(){const e=Scratch.vm.runtime.getTargetForStage();if(!(e instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Attempted to get current costume number of non-sprite");return e.currentCostume+1}function*F(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get x stretch of non-sprite");return t.stretch[0]}function*V(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get y stretch of non-sprite");return t.stretch[1]}function*D(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get variable for a non-sprite");return t.lookupVariableByNameAndType(r,"",!0)?.value??null}function*K(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get variable for a non-sprite");const o=t.lookupVariableByNameAndType(r,"",!0);return o?o.value=String(n):null}function*W(e,t){const r=Scratch.vm.runtime.getTargetForStage();if(!(r instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get variable for a non-sprite");return r.lookupVariableByNameAndType(t,"",!0)?.value??null}function*q(e,t,r){const n=Scratch.vm.runtime.getTargetForStage();if(!(n instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot get variable for a non-sprite");const o=n.lookupVariableByNameAndType(t,"",!0);return o?o.value=String(r):null}function*X(e,t){const r=String(t);return Scratch.vm.runtime.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:r}),null}function*J(e,t,r){if(!(r instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot broadcast to a non-sprite");const n=String(t);return Scratch.vm.runtime.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:n},r),null}function*H(e,t){return t instanceof Scratch.vm.exports.RenderedTarget}function*Z(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget&&r instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Both sprites for isTouchingSprite must be sprites");return!!Scratch.vm.renderer&&Scratch.vm.renderer.isTouchingDrawables(t.drawableID,[r.drawableID])}function*z(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot check if a non-sprite is touching the mouse");if(!Scratch.vm.renderer)return!1;const r=Scratch.vm.runtime.ioDevices.mouse;return!!r&&Scratch.vm.renderer.drawableTouching(t.drawableID,r.getClientX(),r.getClientY())}function*Q(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot check if a non-sprite is touching a point");return!!Scratch.vm.renderer&&Scratch.vm.renderer.drawableTouching(t.drawableID,Number(r)||0,Number(n)||0)}function*ee(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot check if a non-sprite is touching the edge");return t.isTouchingEdge()}function te(){return!!Scratch.vm.runtime.ioDevices.mouse&&Scratch.vm.runtime.ioDevices.mouse.getIsDown()}function re(){return!!Scratch.vm.runtime.ioDevices.mouse&&Scratch.vm.runtime.ioDevices.mouse.getIsClicked()}function*ne(e,t){return!!Scratch.vm.runtime.ioDevices.keyboard&&Scratch.vm.runtime.ioDevices.keyboard.getKeyIsDown(t)}function*oe(e,t){return!!Scratch.vm.runtime.ioDevices.keyboard&&Scratch.vm.runtime.ioDevices.keyboard.getKeyIsHit(t)}function*se(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot create clone of a non-sprite");const r=t.makeClone();return r&&(Scratch.vm.runtime.addTarget(r),r.goBehindOther(t)),r}function*ie(e,t,r,n){let o=t;if("string"==typeof t&&(o=Scratch.vm.runtime.getSpriteTargetByName(t)),!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("The sprite passed to getCloneWithVar is not a sprite name or sprite");const s=o.sprite.clones;for(let e=1;e<s.length;e++){const t=s[e].lookupVariableByNameAndType(r,"",!0);if(t&&0===Scratch.Cast.compare(t.value,n))return s[e]}return null}function*ae({timer:e,isStuck:t,isWarp:r},n){if("number"!=typeof n||Object.is(n,NaN))throw new TypeError("ms in global wait must be a number (and not NaN).");n=Math.max(0,n);const o=new e;for(o.start();o.timeElapsed()<n;)r&&!t()||(yield);return!0}function*pe(e,t,...r){if("function"!=typeof t)throw new TypeError("The first arg to global waitUntil must be a function.");for(const e of r)if("function"!=typeof e)throw new TypeError("All args after the first arg must be functions");for(;yield*ae(e,4);){const n=r.map((t=>t(e)));if(!1===(t(e,...n)??!1))break}return!0}jsGen_1._globalEnv.__env.set("getCostumeName",{get value(){return U}}),jsGen_1._globalEnv.__env.set("getCostumeNumber",{get value(){return G}}),jsGen_1._globalEnv.__env.set("getBackdropName",{get value(){return $}}),jsGen_1._globalEnv.__env.set("getBackdropNumber",{get value(){return Y}}),jsGen_1._globalEnv.__env.set("setCostume",{get value(){return M}}),jsGen_1._globalEnv.__env.set("nextCostume",{get value(){return I}}),jsGen_1._globalEnv.__env.set("previousCostume",{get value(){return P}}),jsGen_1._globalEnv.__env.set("setBackdrop",{get value(){return j}}),jsGen_1._globalEnv.__env.set("nextBackdrop",{get value(){return B}}),jsGen_1._globalEnv.__env.set("previousBackdrop",{get value(){return L}}),jsGen_1._globalEnv.__env.set("say",{get value(){return T}}),jsGen_1._globalEnv.__env.set("think",{get value(){return b}}),jsGen_1._globalEnv.__env.set("setSize",{get value(){return g}}),jsGen_1._globalEnv.__env.set("setVisible",{get value(){return w}}),jsGen_1._globalEnv.__env.set("getSize",{get value(){return x}}),jsGen_1._globalEnv.__env.set("getVisible",{get value(){return N}}),jsGen_1._globalEnv.__env.set("setXStretch",{get value(){return S}}),jsGen_1._globalEnv.__env.set("setYStretch",{get value(){return C}}),jsGen_1._globalEnv.__env.set("setXYStretch",{get value(){return k}}),jsGen_1._globalEnv.__env.set("changeXStretch",{get value(){return O}}),jsGen_1._globalEnv.__env.set("changeYStretch",{get value(){return R}}),jsGen_1._globalEnv.__env.set("changeXYStretch",{get value(){return A}}),jsGen_1._globalEnv.__env.set("getXStretch",{get value(){return F}}),jsGen_1._globalEnv.__env.set("getYStretch",{get value(){return V}}),jsGen_1._globalEnv.__env.set("getSprite",{get value(){return e}}),jsGen_1._globalEnv.__env.set("getX",{get value(){return _}}),jsGen_1._globalEnv.__env.set("getY",{get value(){return v}}),jsGen_1._globalEnv.__env.set("getDirection",{get value(){return E}}),jsGen_1._globalEnv.__env.set("setX",{get value(){return t}}),jsGen_1._globalEnv.__env.set("setY",{get value(){return r}}),jsGen_1._globalEnv.__env.set("setXY",{get value(){return n}}),jsGen_1._globalEnv.__env.set("changeX",{get value(){return o}}),jsGen_1._globalEnv.__env.set("changeY",{get value(){return s}}),jsGen_1._globalEnv.__env.set("changeXY",{get value(){return i}}),jsGen_1._globalEnv.__env.set("moveSteps",{get value(){return m}}),jsGen_1._globalEnv.__env.set("moveBackSteps",{get value(){return d}}),jsGen_1._globalEnv.__env.set("moveUpSteps",{get value(){return y}}),jsGen_1._globalEnv.__env.set("moveDownSteps",{get value(){return f}}),jsGen_1._globalEnv.__env.set("setDirection",{get value(){return c}}),jsGen_1._globalEnv.__env.set("turnLeft",{get value(){return h}}),jsGen_1._globalEnv.__env.set("turnRight",{get value(){return l}}),jsGen_1._globalEnv.__env.set("degToRad",{get value(){return a}}),jsGen_1._globalEnv.__env.set("radToDeg",{get value(){return p}}),jsGen_1._globalEnv.__env.set("getVariableForSprite",{get value(){return D}}),jsGen_1._globalEnv.__env.set("setVariableForSprite",{get value(){return K}}),jsGen_1._globalEnv.__env.set("getVariableForAllSprites",{get value(){return W}}),jsGen_1._globalEnv.__env.set("setVariableForAllSprites",{get value(){return q}}),jsGen_1._globalEnv.__env.set("broadcast",{get value(){return X}}),jsGen_1._globalEnv.__env.set("broadcastToSprite",{get value(){return J}}),jsGen_1._globalEnv.__env.set("isSprite",{get value(){return H}}),jsGen_1._globalEnv.__env.set("isTouchingSprite",{get value(){return Z}}),jsGen_1._globalEnv.__env.set("isTouchingMouse",{get value(){return z}}),jsGen_1._globalEnv.__env.set("isTouchingXY",{get value(){return Q}}),jsGen_1._globalEnv.__env.set("isTouchingEdge",{get value(){return ee}}),jsGen_1._globalEnv.__env.set("mouseDown",{get value(){return!!Scratch.vm.runtime.ioDevices.mouse&&Scratch.vm.runtime.ioDevices.mouse.getIsDown()}}),jsGen_1._globalEnv.__env.set("mouseClicked",{get value(){return!!Scratch.vm.runtime.ioDevices.mouse&&Scratch.vm.runtime.ioDevices.mouse.getIsClicked()}}),jsGen_1._globalEnv.__env.set("mouseX",{get value(){return Scratch.vm.runtime.ioDevices.mouse?Scratch.vm.runtime.ioevices.mouse.getScratchX():0}}),jsGen_1._globalEnv.__env.set("mouseY",{get value(){return Scratch.vm.runtime.ioDevices.mouse?Scratch.vm.runtime.ioevices.mouse.getScratchY():0}}),jsGen_1._globalEnv.__env.set("isKeyDown",{get value(){return ne}}),jsGen_1._globalEnv.__env.set("isKeyHit",{get value(){return oe}}),jsGen_1._globalEnv.__env.set("createClone",{get value(){return se}}),jsGen_1._globalEnv.__env.set("getCloneWithVar",{get value(){return ie}}),jsGen_1._globalEnv.__env.set("wait",{get value(){return ae}}),jsGen_1._globalEnv.__env.set("waitUntil",{get value(){return pe}});let ue=self.performance.now();function*ce(){return self.performance.now()-ue}jsGen_1._globalEnv.__env.set("applicationTime",{get value(){return ce}}),jsGen_1._globalEnv.__env.set("timeSinceBlueFlag",{get value(){return ce}}),Scratch.vm.runtime.on("PROJECT_START",(()=>ue=self.performance.now()));const le=Scratch.vm.runtime.ext_scratch3_sound;function*he(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot play sound from a non-sprite");if("string"!=typeof r&&"number"!=typeof r)throw new TypeError("Sound must be a string or number index");"number"!=typeof n&&(n=Number(n)||0),le._playSoundAtTimePosition({sound:Scratch.Cast.toString(r),seconds:n},{target:t},!0)}function*me(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot play sound from a non-sprite");if("string"!=typeof r&&"number"!=typeof r)throw new TypeError("Sound must be a string or number index");"number"!=typeof n&&(n=Number(n)||0),yield*e.waitPromise(le._playSoundAtTimePosition({sound:Scratch.Cast.toString(r),seconds:n},{target:t},!0))}function*de(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot play all sounds from a non-sprite");const r=t.sprite;if(!r)return null;for(let e=0;e<r.sounds.length;e++){const{soundId:n}=r.sounds[e];r.soundBank&&(r.soundBank.playSound(t,n),le._addWaitingSound(t.id,n))}}function*ye(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot play all sounds from a non-sprite");const r=t.sprite;if(!r)return null;const n=[];for(let e=0;e<r.sounds.length;e++){const{soundId:o}=r.sounds[e];r.soundBank&&(n.push(r.soundBank.playSound(t,o)),le._addWaitingSound(t.id,o))}yield*e.waitPromise(Promise.all(n))}function*fe(e,t,r){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot stop sound from a non-sprite");if("string"!=typeof r&&"number"!=typeof r)throw new TypeError("Sound must be a string or number index");le.stopSpecificSound({SOUND_MENU:r},{target:t})}function*_e(e,t){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot stop all sound from a non-sprite");le._stopAllSoundsForTarget(t)}function*ve(e){le.stopAllSounds()}function*Ee(e,t,r,n){if(!(t instanceof Scratch.vm.exports.RenderedTarget))throw new TypeError("Cannot set fadeout of a sound from a non-sprite");if("string"!=typeof r&&"number"!=typeof r)throw new TypeError("Sound must be a string or number index");n=Number(n)||0,le.setStopFadeout({SOUND_MENU:r,VALUE:n},{target:t})}function*Te(e,t,r){return e.tempVars[String(t)]=r}function*be(e,t,r){return e.tempVars[String(t)]}function*ge(e,t,r){return!!e.tempVars[String(t)]}jsGen_1._globalEnv.__env.set("playSound",{get value(){return he}}),jsGen_1._globalEnv.__env.set("stopSound",{get value(){return fe}}),jsGen_1._globalEnv.__env.set("stopAllSoundsForSprite",{get value(){return _e}}),jsGen_1._globalEnv.__env.set("stopAllSounds",{get value(){return ve}}),jsGen_1._globalEnv.__env.set("playSoundAndWait",{get value(){return me}}),jsGen_1._globalEnv.__env.set("playAllSounds",{get value(){return de}}),jsGen_1._globalEnv.__env.set("playAllSoundsAndWait",{get value(){return ye}}),jsGen_1._globalEnv.__env.set("setFadeout",{get value(){return Ee}}),jsGen_1._globalEnv.__env.set("setTempVar",{get value(){return Te}}),jsGen_1._globalEnv.__env.set("getTempVar",{get value(){return Te}}),jsGen_1._globalEnv.__env.set("tempVarExists",{get value(){return ge}}),jsGen_1._globalEnv.__env.set("RegExp",{get value(){return null}}),customObjectTypes.sprite=e=>e instanceof Scratch.vm.exports.RenderedTarget;class we{_globalEnv=jsGen_1._globalEnv;_customObjectTypes=customObjectTypes;constructor(){Scratch.vm.runtime.registerCompiledExtensionBlocks("vgspenguinscript",this.getCompiledInfo())}getCompiledInfo(){return{ir:{evalStack:(e,t)=>(e.script.yields=!0,{kind:"stack",code:e.descendInputOfBlock(t,"code")}),evalReporter:(e,t)=>(e.script.yields=!0,{kind:"input",code:e.descendInputOfBlock(t,"code")})},js:{evalStack:(e,t,r)=>{const n=t.descendInput(e.code);t.source+=`(yield* runtime.ext_vgspenguinscript.transpile(${n.asString()}, ${t.warpTimer}, ${t.isWarp})(runtime.ext_vgspenguinscript._globalEnv, {target, isStuck, waitPromise, thread: globalState.thread, timer: globalState.Timer, warpTimer: ${t.warpTimer}, isWarp: ${t.isWarp}, tempVars, ...runtime.ext_vgspenguinscript.utilObject}));`},evalReporter:(e,t,r)=>{const n=t.descendInput(e.code);return canNullish?new r.TypedInput(`((yield* runtime.ext_vgspenguinscript.transpile(${n.asString()}, ${t.warpTimer}, ${t.isWarp})(runtime.ext_vgspenguinscript._globalEnv, {target, isStuck, waitPromise, thread: globalState.thread, timer: globalState.Timer, warpTimer: ${t.warpTimer}, isWarp: ${t.isWarp}, tempVars, ...runtime.ext_vgspenguinscript.utilObject}))  ?? "null")`,r.TYPE_UNKNOWN):new r.TypedInput(`nullish((yield* runtime.ext_vgspenguinscript.transpile(${n.asString()}, ${t.warpTimer}, ${t.isWarp})(runtime.ext_vgspenguinscript._globalEnv, {target, isStuck, waitPromise, thread: globalState.thread, timer: globalState.Timer, warpTimer: ${t.warpTimer}, isWarp: ${t.isWarp}, tempVars, ...runtime.ext_vgspenguinscript.utilObject})),"null")`,r.TYPE_UNKNOWN)}}}}getInfo(){return{id:"vgspenguinscript",name:"PenguinScript",docsURI:"https://extensions.penguinmod.com/docs/penguinscript",blocks:[{opcode:"evalStack",blockType:Scratch.BlockType.COMMAND,text:"evaluate [code]",func:"noComp",arguments:{code:{type:Scratch.ArgumentType.STRING,defaultValue:'let x = "I am some text!"; global say(target, x);'}}},{opcode:"evalReporter",allowDropAnywhere:!0,blockType:Scratch.BlockType.REPORTER,text:"evaluate [code]",func:"noComp",arguments:{code:{type:Scratch.ArgumentType.STRING,defaultValue:"const var = 69;return var;"}}}]}}noComp(){throw"Please enable compiler."}transpile(e,t,r){return transpile(e,t,r)}getLexer(){return lexer_1.default}getParser(){return parser_1.default}getJSGenerator(){return jsGen_1.default}getGlobalEnv(){return jsGen_1._globalEnv}utilObject={createError:createErrorStruct,createObject:createObjectStruct,createArray:createArrayStruct,createComplex:createComplexStruct,*negate(e){return e&&e.isComplex&&e.isStruct?yield*createComplexStruct(this,new Complex(e.props.re.value,e.props.im.value).neg()):-Number(e)},*lt(e,t){return!(e&&e.isComplex&&e.isStruct)&&!(t&&t.isComplex&&t.isStruct)&&Number(e)<Number(t)},*le(e,t){return!(e&&e.isComplex&&e.isStruct)&&!(t&&t.isComplex&&t.isStruct)&&Number(e)<=Number(t)},*gt(e,t){return!(e&&e.isComplex&&e.isStruct)&&!(t&&t.isComplex&&t.isStruct)&&Number(e)>Number(t)},*ge(e,t){return!(e&&e.isComplex&&e.isStruct)&&!(t&&t.isComplex&&t.isStruct)&&Number(e)>=Number(t)},*is(e,t){return e&&t&&e.isComplex&&t.isComplex||e&&e.isComplex&&"number"==typeof t?yield*e.props.__equals__.value(this,t):t&&t.isComplex&&"number"==typeof e?yield*t.props.__equals__.value(this,e):Object.is(e,t)},*add(e,t){return e&&e.isComplex&&e.isStruct&&(yield*e.props.__isCompatible__.value(this,t))?yield*e.props.__add__.value(this,t):t&&t.isComplex&&t.isStruct&&(yield*t.props.__isCompatible__.value(this,e))?yield*t.props.__add__.value(this,e):Number(e)+Number(t)},*subtract(e,t){return e&&e.isComplex&&e.isStruct&&(yield*e.props.__isCompatible__.value(this,t))?yield*e.props.__subtract__.value(this,t):t&&t.isComplex&&t.isStruct&&(yield*t.props.__isCompatible__.value(this,e))?yield*t.props.__subtract__.value(this,e):Number(e)-Number(t)},*multiply(e,t){return e&&e.isComplex&&e.isStruct&&(yield*e.props.__isCompatible__.value(this,t))?yield*e.props.__multiply__.value(this,t):t&&t.isComplex&&t.isStruct&&(yield*t.props.__isCompatible__.value(this,e))?yield*t.props.__multiply__.value(this,e):Number(e)*Number(t)},*divide(e,t){return e&&e.isComplex&&e.isStruct&&(yield*e.props.__isCompatible__.value(this,t))?yield*e.props.__divide__.value(this,t):t&&t.isComplex&&t.isStruct&&(yield*t.props.__isCompatible__.value(this,e))?yield*t.props.__divide__.value(this,e):Number(e)/Number(t)},*mod(e,t){if(e&&e.isComplex||t&&t.isComplex)throw new TypeError("Complex operation not implemented");const r=Number(e),n=Number(t);let o=r%n;return o/n<0&&(o+=n),o},*power(e,t){return e&&e.isComplex&&e.isStruct&&(yield*e.props.__isCompatible__.value(this,t))?yield*e.props.__power__.value(this,t):t&&t.isComplex&&t.isStruct&&(yield*t.props.__isCompatible__.value(this,e))?yield*t.props.__power__.value(this,e):Number(e)**Number(t)}}}"object"==typeof LoadedAsCore&&LoadedAsCore!==globalThis.LoadedAsCore?module.exports=we:Scratch.extensions.register(new we)}"object"==typeof LoadedAsCore&&LoadedAsCore!==globalThis.LoadedAsCore||(module.exports={Lexer:lexer_1.default,Parser:parser_1.default,JSGenerator:jsGen_1.default,transpile,default:transpile})},19:(e,t)=>{"use strict";var r,n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TokenToPrecedence=t.PrecendenceRules=t.Precedence=t.OutputType=t.NodeType=void 0,function(e){e[e.Program=0]="Program",e[e.VariableDeclaration=1]="VariableDeclaration",e[e.AssignmentExpr=2]="AssignmentExpr",e[e.Identifier=3]="Identifier",e[e.PrimitiveLiteral=4]="PrimitiveLiteral",e[e.BinaryExpr=5]="BinaryExpr",e[e.UnaryExpr=6]="UnaryExpr",e[e.StmtBlock=7]="StmtBlock",e[e.IfStatement=8]="IfStatement",e[e.NoOp=9]="NoOp",e[e.ElseStatement=10]="ElseStatement",e[e.While=11]="While",e[e.Function=12]="Function",e[e.Inline=13]="Inline",e[e.ReturnStatement=14]="ReturnStatement",e[e.ArgsList=15]="ArgsList",e[e.FunctionCall=16]="FunctionCall",e[e.Global=17]="Global",e[e.Target=18]="Target",e[e.Break=19]="Break",e[e.Continue=20]="Continue",e[e.Struct=21]="Struct",e[e.Chaining=22]="Chaining",e[e.Try=23]="Try",e[e.In=24]="In",e[e.Ternary=25]="Ternary",e[e.Object=26]="Object",e[e.Array=27]="Array",e[e.RegExp=28]="RegExp",e[e.Complex=29]="Complex",e[e.ErrorLiteral=30]="ErrorLiteral"}(r||(t.NodeType=r={})),function(e){e[e.String=0]="String",e[e.Number=1]="Number",e[e.Boolean=2]="Boolean",e[e.Object=3]="Object",e[e.List=4]="List",e[e.VariableReference=5]="VariableReference",e[e.Userdata=6]="Userdata"}(n||(t.OutputType=n={})),function(e){e[e.ASSIGNMENT=0]="ASSIGNMENT",e[e.NOT=1]="NOT",e[e.AND=2]="AND",e[e.XOR=3]="XOR",e[e.OR=4]="OR",e[e.ADDITIVE=5]="ADDITIVE",e[e.MULTIPLICATIVE=6]="MULTIPLICATIVE",e[e.EXPONENTIAL=7]="EXPONENTIAL",e[e.PRIMARY_EXPR=8]="PRIMARY_EXPR"}(o||(t.Precedence=o={})),t.PrecendenceRules={},t.TokenToPrecedence=function(e){return o.ASSIGNMENT}},345:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Token=t.TokenType=void 0,function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.TRUE=2]="TRUE",e[e.FALSE=3]="FALSE",e[e.NULL=4]="NULL",e[e.IDENTIFIER=5]="IDENTIFIER",e[e.LET=6]="LET",e[e.CONST=7]="CONST",e[e.IF=8]="IF",e[e.ELSE=9]="ELSE",e[e.WHILE=10]="WHILE",e[e.FUNCTION=11]="FUNCTION",e[e.RETURN=12]="RETURN",e[e.INLINE=13]="INLINE",e[e.GLOBAL=14]="GLOBAL",e[e.TARGET=15]="TARGET",e[e.BREAK=16]="BREAK",e[e.CONTINUE=17]="CONTINUE",e[e.STRUCT=18]="STRUCT",e[e.TRY=19]="TRY",e[e.CATCH=20]="CATCH",e[e.FINALLY=21]="FINALLY",e[e.EQUALS=22]="EQUALS",e[e.BINARY_OPERATOR=23]="BINARY_OPERATOR",e[e.UNARY_OPERATOR=24]="UNARY_OPERATOR",e[e.SEMICOLON=25]="SEMICOLON",e[e.COMMA=26]="COMMA",e[e.OPEN_PAREN=27]="OPEN_PAREN",e[e.CLOSE_PAREN=28]="CLOSE_PAREN",e[e.OPEN_BRACE=29]="OPEN_BRACE",e[e.CLOSE_BRACE=30]="CLOSE_BRACE",e[e.OPEN_BRACKET=31]="OPEN_BRACKET",e[e.CLOSE_BRACKET=32]="CLOSE_BRACKET",e[e.CHAINING=33]="CHAINING",e[e.RESERVED=34]="RESERVED",e[e.EOF=35]="EOF"}(r||(t.TokenType=r={}));class n{type;raw;constructor(e=r.EOF,t=""){this.type=e,this.raw=t}}t.Token=n,t.default=class{Token=n;TokenType=r;Keywords={let:r.LET,const:r.CONST,and:r.BINARY_OPERATOR,or:r.BINARY_OPERATOR,xor:r.BINARY_OPERATOR,not:r.UNARY_OPERATOR,if:r.IF,else:r.ELSE,false:r.FALSE,true:r.TRUE,null:r.NULL,while:r.WHILE,repeatUntil:r.WHILE,forever:r.WHILE,fn:r.FUNCTION,return:r.RETURN,inline:r.INLINE,global:r.GLOBAL,target:r.TARGET,for:r.RESERVED,this:r.RESERVED,self:r.RESERVED,struct:r.STRUCT,enum:r.RESERVED,break:r.BREAK,continue:r.CONTINUE,try:r.TRY,catch:r.CATCH,finally:r.FINALLY,in:r.BINARY_OPERATOR};constructor(e){this.src=e,this.srcArr=e.split(""),this.tokens=[]}*yieldToken(e){this.tokens.push(e),yield e}*tokenize(){const e=this.srcArr;for(;e.length>0;)switch(e[0]){case" ":case"\n":case"\r":e.shift();break;case"(":{const t=new n(r.OPEN_PAREN,e.shift());this.tokens.push(t),yield t;break}case")":{const t=new n(r.CLOSE_PAREN,e.shift());this.tokens.push(t),yield t;break}case"{":{const t=new n(r.OPEN_BRACE,e.shift());this.tokens.push(t),yield t;break}case"}":{const t=new n(r.CLOSE_BRACE,e.shift());this.tokens.push(t),yield t;break}case"[":{const t=new n(r.OPEN_BRACKET,e.shift());this.tokens.push(t),yield t;break}case"]":{const t=new n(r.CLOSE_BRACKET,e.shift());this.tokens.push(t),yield t;break}case"-":if(">"===e[1]){yield*this.yieldToken(new n(r.CHAINING,e.shift()+e.shift()));break}if("-"===e[1]){yield*this.yieldToken(new n(r.RESERVED,e.shift()+e.shift()));break}case"+":if("+"===e[1]){yield*this.yieldToken(new n(r.RESERVED,e.shift()+e.shift()));break}case"<":case">":case"+":case"*":case"/":case"%":case"^":{const t=new n(r.BINARY_OPERATOR,e.shift());yield*this.yieldToken(t);break}case"=":{let t;t="="===e[1]?new n(r.BINARY_OPERATOR,e.shift()+e.shift()):">"===e[1]?new n(r.RESERVED,e.shift()+e.shift()):new n(r.EQUALS,e.shift()),yield*this.yieldToken(t);break}case";":{const t=new n(r.SEMICOLON,e.shift());yield*this.yieldToken(t);break}case",":{const t=new n(r.COMMA,e.shift());yield*this.yieldToken(t);break}default:if(/^[_a-zA-Z]$/.test(e[0])){let t="";for(;"string"==typeof e[0]&&/^[_a-zA-Z]+[_a-zA-Z0-9]*$/.test(t+e[0])&&e.length>0;t+=e.shift());let o=this.Keywords[t];o?yield*this.yieldToken(new n(o,t)):yield*this.yieldToken(new n(r.IDENTIFIER,t))}else if('"'===e[0]){e.shift();let t="";for(;"string"==typeof e[0]&&'"'!==e[0]&&e.length>0;){const r=e.shift();if("\\"===r){const r=e.shift();switch(r){case"n":t+="\n";break;case"f":t+="\f";break;case"r":t+="\r";break;case"t":t+="\t";break;case"v":t+="\v";break;case"b":t+="\b";break;case"c":{const r=e.shift();if(!r||!/^[a-zA-Z]$/.test(r))throw new SyntaxError(`Expected letter after escape sequence \\c, got ${r||"<EOF>"} instead`);t+=String.fromCodePoint(r.codePointAt(0)||0);break}case"x":{let r,n;if(!/^[0-9a-fA-F]+$/.test((r=e[0])+(n=e[1])))throw new SyntaxError(`Expected two hexadecimal digits after escape sequence \\x, got ${r||"<EOF>"}${r?n||" and <EOF>":""} instead`);t+=String.fromCodePoint(Number("0x"+e.shift()+e.shift()));break}case"u":if(!/^[0-9a-fA-F]+$/.test(e.slice(0,4).join("")))throw new SyntaxError("Invalid Unicode escape sequence, expected 4 hexadecimal digits. ");t+=String.fromCodePoint(Number("0x"+e.shift()+e.shift()+e.shift()+e.shift()));break;case"U":if(!/^[0-9a-fA-F]+$/.test(e.slice(0,6).join("")))throw new SyntaxError("Invalid Unicode escape sequence, expected 6 hexadecimal digits. ");t+=String.fromCodePoint(Number("0x"+e.shift()+e.shift()+e.shift()+e.shift()+e.shift()+e.shift()));break;case"s":t+="馃拃";break;case"m":t+="馃椏";break;case"z":t+="馃ザ";break;case"l":case"T":t+="馃悽";break;case"F":t+="馃敟";break;case"S":case"a":t+="鉁?;break;case"p":t+="馃惂";break;case"0":t+="\0";break;default:t+=r||""}}else t+=r}if('"'!==e.shift())throw new SyntaxError("Expected closing quotes, got <EOF> instead.");yield*this.yieldToken(new n(r.STRING,t))}else{if(!/^[0-9]$/.test(e[0]))throw new SyntaxError("Unknown character: "+e.shift());{let t="";if("0"===e[0]&&"x"===e[1]){for(e.shift(),e.shift();/^[0-9a-fA-F]$/.test(e[0])&&e.length>0;t+=e.shift());yield*this.yieldToken(new n(r.NUMBER,"0x"+t))}else if("0"===e[0]&&"o"===e[1]){for(e.shift(),e.shift();/^[0-7]$/.test(e[0])&&e.length>0;t+=e.shift());yield*this.yieldToken(new n(r.NUMBER,"0o"+t))}else if("0"===e[0]&&"b"===e[1]){for(e.shift(),e.shift();/^[01]$/.test(e[0])&&e.length>0;t+=e.shift());yield*this.yieldToken(new n(r.NUMBER,"0b"+t))}else{for(;/^[0-9]$/.test(e[0])&&e.length>0;t+=e.shift());if("."===e[0]&&/^[0-9]$/.test(String(e[1]))){for(t+=e.shift(),t+=e.shift();/^[0-9]$/.test(e[0])&&e.length>0;t+=e.shift());if("e"===e[0]||"E"===e[0]){t+=e.shift();let r="";"+"!==e[0]&&"-"!==e[0]||(r=e.shift());let n="";for(;/^[0-9]$/.test(e[0])&&e.length>0;n+=e.shift());t+=r+n}}yield*this.yieldToken(new n(r.NUMBER,t))}}}}yield*this.yieldToken(new n)}tokenizeNonGen(){this.tokens=[];const e=[];try{for(const t of this.tokenize())e.push(t)}catch(t){return{error:t,tokens:e}}return{error:null,tokens:e}}src;srcArr;tokens}},56:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(19),o=r(345);t.default=class{constructor(e){if(Array.isArray(e))this.tokens=e;else{const t=new o.default(e).tokenizeNonGen();if(t.error)throw t.error instanceof Error&&(t.error.name="(PenguinScript Parsing Error) "+t.error.name),t.error;this.tokens=t.tokens}}tokens=[];not_eof(){return this.tokens[0]?.type!==o.TokenType.EOF}at(){return this.tokens[0]}eat(){return this.tokens.shift()}expect(...e){const t=this.eat();if(!t||-1===e.indexOf(t.type))throw new SyntaxError(`Expected ${e.map((e=>o.TokenType[e])).join(", ")} token, got ${o.TokenType[t?.type]} instead`);return t}optional(e){return this.at().type===e?this.eat():null}produceAST(){const e={kind:n.NodeType.Program,body:[]};try{for(;this.not_eof();)e.body.push(this.parse_stmt())}catch(e){throw e instanceof Error&&(e.name="(PenguinScript.Parsing Error) "+e.name),e}return e}parse_stmt(){switch(this.at().type){case o.TokenType.LET:case o.TokenType.CONST:return this.parse_variable_declaration();case o.TokenType.OPEN_BRACE:{this.eat();const e=[];for(;this.at().type!==o.TokenType.CLOSE_BRACE&&this.not_eof();){const t=this.parse_stmt();e.push(t)}return this.expect(o.TokenType.CLOSE_BRACE),{kind:n.NodeType.StmtBlock,body:e}}case o.TokenType.IF:return this.parse_if();case o.TokenType.WHILE:return this.parse_loop();case o.TokenType.ELSE:throw new SyntaxError("Unexpected else statement.");case o.TokenType.SEMICOLON:return this.eat(),{kind:n.NodeType.NoOp};case o.TokenType.RETURN:return this.parse_return();case o.TokenType.BREAK:return this.eat(),{kind:n.NodeType.Break};case o.TokenType.CONTINUE:return this.eat(),{kind:n.NodeType.Continue};case o.TokenType.TRY:return this.parse_tryCatchFinally();default:return this.parse_expr()}}parse_tryCatchFinally(){this.eat();const e=this.parse_stmt();let t,r,s;return this.expect(o.TokenType.CATCH,o.TokenType.FINALLY).type===o.TokenType.CATCH?(r=this.expect(o.TokenType.IDENTIFIER).raw,t=this.parse_stmt(),this.at().type===o.TokenType.FINALLY&&(this.eat(),s=this.parse_stmt())):(s=this.parse_stmt(),this.at().type===o.TokenType.CATCH&&(this.eat(),r=this.expect(o.TokenType.IDENTIFIER).raw,t=this.parse_stmt())),{kind:n.NodeType.Try,body:e,catch:t,catchVar:r,finally:s}}parse_return(){this.eat();const e=this.parse_expr();return this.at().type===o.TokenType.SEMICOLON&&this.eat(),{kind:n.NodeType.ReturnStatement,value:e}}parse_function(){let e="";this.eat(),this.at().type===o.TokenType.IDENTIFIER&&(e=this.eat().raw);const t=this.parse_argslist();this.expect(o.TokenType.OPEN_BRACE);const r=[];for(;this.at().type!==o.TokenType.CLOSE_BRACE&&this.not_eof();){const e=this.parse_stmt();r.push(e)}this.expect(o.TokenType.CLOSE_BRACE);const s={kind:n.NodeType.StmtBlock,body:r};return{kind:n.NodeType.Function,args:t,body:s,symbol:e}}parse_argslist(){this.expect(o.TokenType.OPEN_PAREN);const e=[];for(;this.at().type!==o.TokenType.CLOSE_PAREN&&this.not_eof();){let t=this.parse_primary_expr();if(t.kind!==n.NodeType.Identifier)throw new SyntaxError("Expected parameter name.");this.at().type!==o.TokenType.CLOSE_PAREN?this.expect(o.TokenType.COMMA):this.at().type===o.TokenType.COMMA&&this.eat(),e.forEach((e=>{if(e.symbol===t.symbol)throw new SyntaxError("Duplicate parameter name")})),e.push(t)}return this.expect(o.TokenType.CLOSE_PAREN),{kind:n.NodeType.ArgsList,args:e}}parse_inline(){this.eat();const e=this.parse_stmt();if(e.kind===n.NodeType.VariableDeclaration)throw new SyntaxError("Cannot declare a variable in a single-statement context");return{kind:n.NodeType.Inline,body:e}}parse_loop(){switch(this.eat().raw){case"while":return{kind:n.NodeType.While,condition:this.parse_expr(),body:this.parse_stmt()};case"repeatUntil":return{kind:n.NodeType.While,condition:{kind:n.NodeType.UnaryExpr,operand:this.parse_expr(),operator:"not"},body:this.parse_stmt()};case"forever":return{kind:n.NodeType.While,condition:{kind:n.NodeType.PrimitiveLiteral,value:!0},body:this.parse_stmt()}}}parse_if(){this.eat();const e=this.parse_expr(),t=this.parse_stmt();let r;if(this.at().type===o.TokenType.ELSE){this.eat();const o=this.parse_stmt();return r={kind:n.NodeType.ElseStatement,body:o},{kind:n.NodeType.IfStatement,body:t,condition:e,else:r}}return{kind:n.NodeType.IfStatement,body:t,condition:e}}parse_variable_declaration(){const e=this.eat().type===o.TokenType.CONST,t=this.expect(o.TokenType.IDENTIFIER).raw;if(this.at().type===o.TokenType.SEMICOLON){if(this.eat(),e)throw new SyntaxError("Must declare constant with initializer");return{kind:n.NodeType.VariableDeclaration,constant:!1,symbol:t}}return this.expect(o.TokenType.EQUALS),{kind:n.NodeType.VariableDeclaration,constant:e,symbol:t,value:this.parse_expr()}}parse_expr(){return this.parse_assignment_expr()}parse_not_expr(){if("not"===this.at().raw&&this.at().type===o.TokenType.UNARY_OPERATOR){this.eat();const e=this.parse_not_expr();return{kind:n.NodeType.UnaryExpr,operand:e,operator:"not"}}return this.parse_primary_expr()}parse_and_expr(){let e=this.parse_xor_expr();for(;"and"===this.at().raw&&this.at().type===o.TokenType.BINARY_OPERATOR;){const t=this.eat().raw,r=this.parse_xor_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_xor_expr(){let e=this.parse_or_expr();for(;"xor"===this.at().raw&&this.at().type===o.TokenType.BINARY_OPERATOR;){const t=this.eat().raw,r=this.parse_or_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_or_expr(){let e=this.parse_relational_expr();for(;"or"===this.at().raw&&this.at().type===o.TokenType.BINARY_OPERATOR;){const t=this.eat().raw,r=this.parse_relational_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_relational_expr(){let e=this.parse_additive_expr();for(;("<"===this.at().raw||">"===this.at().raw||"=="===this.at().raw)&&this.at().type===o.TokenType.BINARY_OPERATOR;){let t=this.eat().raw;"<"!==t&&">"!==t||(this.at().type===o.TokenType.EQUALS&&this.eat(),t+="=");const r=this.parse_additive_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_assignment_expr(){const e=this.parse_ternary_expr();if(this.at().type===o.TokenType.EQUALS){this.eat();const t=this.parse_assignment_expr();return{kind:n.NodeType.AssignmentExpr,value:t,assigne:e}}return e}parse_ternary_expr(){this.at().type===o.TokenType.IF&&this.eat();let e=this.parse_and_expr();for(;this.at().type===o.TokenType.IF;){const t=this.parse_expr();let r;this.at().type===o.TokenType.ELSE&&(this.eat(),r=this.parse_expr()),e={kind:n.NodeType.Ternary,body:t,condition:e,else:r}}return e}parse_additive_expr(){let e=this.parse_multiplicative_expr();for(;("+"===this.at().raw||"-"===this.at().raw)&&this.at().type===o.TokenType.BINARY_OPERATOR;){const t=this.eat().raw,r=this.parse_multiplicative_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_multiplicative_expr(){let e=this.parse_exponential_expr();for(;("*"===this.at().raw||"/"===this.at().raw||"%"===this.at().raw)&&this.at().type===o.TokenType.BINARY_OPERATOR;){const t=this.eat().raw,r=this.parse_exponential_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_exponential_expr(){let e=this.parse_chaining_function_call_expr();for(;"^"===this.at().raw&&this.at().type===o.TokenType.BINARY_OPERATOR;){const t=this.eat().raw,r=this.parse_exponential_expr();e={kind:n.NodeType.BinaryExpr,left:e,right:r,operator:t}}return e}parse_chaining_function_call_expr(){let e=this.parse_in_expr();for(;this.at().type===o.TokenType.OPEN_PAREN;){this.expect(o.TokenType.OPEN_PAREN);const t=[];for(;this.at().type!==o.TokenType.CLOSE_PAREN&&this.not_eof();){const e=this.parse_expr();this.at().type!==o.TokenType.CLOSE_PAREN?this.expect(o.TokenType.COMMA):this.at().type===o.TokenType.COMMA&&this.eat(),t.push(e)}this.expect(o.TokenType.CLOSE_PAREN),e={kind:n.NodeType.FunctionCall,func:e,args:t}}for(;this.at().type===o.TokenType.CHAINING;){this.eat();let t=this.expect(o.TokenType.STRING,o.TokenType.IDENTIFIER).raw;for(e={kind:n.NodeType.Chaining,item:e,index:t};this.at().type===o.TokenType.OPEN_PAREN;){this.expect(o.TokenType.OPEN_PAREN);const t=[];for(;this.at().type!==o.TokenType.CLOSE_PAREN&&this.not_eof();){const e=this.parse_expr();this.at().type!==o.TokenType.CLOSE_PAREN?this.expect(o.TokenType.COMMA):this.at().type===o.TokenType.COMMA&&this.eat(),t.push(e)}this.expect(o.TokenType.CLOSE_PAREN),e={kind:n.NodeType.FunctionCall,func:e,args:t}}}return e}parse_in_expr(){const e=this.at().type===o.TokenType.IDENTIFIER||this.at().type===o.TokenType.STRING;let t=this.parse_primary_expr();if(this.at().type===o.TokenType.BINARY_OPERATOR&&"in"===this.at().raw){if(this.eat(),!e)throw new SyntaxError("Left side of in must be an identifier or string");let r=this.parse_in_expr();t={kind:n.NodeType.In,item:r,index:t.symbol||t.value}}return t}parse_struct(){this.eat(),this.expect(o.TokenType.OPEN_BRACKET);const e=[];for(;this.at().type!==o.TokenType.CLOSE_BRACKET;){let t="";t=this.at().type===o.TokenType.STRING?this.eat().raw:this.expect(o.TokenType.IDENTIFIER).raw;let r=null;this.at().type===o.TokenType.EQUALS&&(this.eat(),r=this.parse_expr()),this.expect(o.TokenType.SEMICOLON),e.forEach((e=>{if(t===e[0])throw new SyntaxError("Duplicate member name in struct.")})),e.push([t,r])}return this.expect(o.TokenType.CLOSE_BRACKET),{kind:n.NodeType.Struct,body:e}}parse_complicated_literals(){this.eat();let e="o";switch(this.at().type!==o.TokenType.IDENTIFIER&&this.at().type!==o.TokenType.STRING||(e=this.eat().raw,this.expect(o.TokenType.SEMICOLON)),e){case"o":{const e=[];for(;this.at().type!==o.TokenType.CLOSE_BRACKET&&this.not_eof();){const t=[],r=this.at().type===o.TokenType.IDENTIFIER,s=this.at().type===o.TokenType.GLOBAL;let i=this.parse_expr();if(this.at().type===o.TokenType.CHAINING)r&&(i={kind:n.NodeType.PrimitiveLiteral,value:i.symbol}),t.push(i),this.eat(),t.push(this.parse_expr());else{if(!r&&!s)throw new SyntaxError("Invalid shorthand property or missing -> arrow");const e=i;t.push({kind:n.NodeType.PrimitiveLiteral,value:e.symbol}),t.push(e)}this.at().type!==o.TokenType.CLOSE_BRACKET?this.expect(o.TokenType.COMMA):this.optional(o.TokenType.COMMA),e.push(t)}return this.expect(o.TokenType.CLOSE_BRACKET),{kind:n.NodeType.Object,body:e}}case"a":{const e=[];for(;this.at().type!==o.TokenType.CLOSE_BRACKET&&this.not_eof();)e.push(this.parse_expr()),this.at().type!==o.TokenType.CLOSE_BRACKET?this.expect(o.TokenType.COMMA):this.optional(o.TokenType.COMMA);return this.expect(o.TokenType.CLOSE_BRACKET),{kind:n.NodeType.Array,body:e}}case"c":{let e,t;return this.at().type!==o.TokenType.CLOSE_BRACKET&&(e=this.parse_expr()),this.at().type!==o.TokenType.CLOSE_BRACKET&&(this.expect(o.TokenType.SEMICOLON),t=this.parse_expr(),this.optional(o.TokenType.SEMICOLON)),this.expect(o.TokenType.CLOSE_BRACKET),{kind:n.NodeType.Complex,re:e,im:t}}case"er":{let e={kind:n.NodeType.PrimitiveLiteral,value:""},t={kind:n.NodeType.PrimitiveLiteral,value:"Error"};return this.at().type!==o.TokenType.CLOSE_BRACKET&&(e=this.parse_expr()),this.at().type!==o.TokenType.CLOSE_BRACKET&&(this.expect(o.TokenType.SEMICOLON),t=this.parse_expr(),this.optional(o.TokenType.SEMICOLON)),this.expect(o.TokenType.CLOSE_BRACKET),{kind:n.NodeType.ErrorLiteral,msg:e,type:t}}default:throw new SyntaxError("Unknown special literal type: "+e)}}parse_primary_expr(){const e=this.at().type;switch(e){case o.TokenType.BINARY_OPERATOR:if("-"!==this.eat().raw)throw new SyntaxError(`Invalid or unexpected token ${o.TokenType[e]}.`);return{kind:n.NodeType.UnaryExpr,operand:this.parse_primary_expr(),operator:"-"};case o.TokenType.IDENTIFIER:return{kind:n.NodeType.Identifier,symbol:this.eat().raw};case o.TokenType.OPEN_BRACKET:return this.parse_complicated_literals();case o.TokenType.UNARY_OPERATOR:if("not"===this.at().raw)return this.parse_not_expr();throw new SyntaxError("Unknown unary operator "+this.at().raw);case o.TokenType.GLOBAL:if(this.eat(),this.at().type!==o.TokenType.IDENTIFIER)throw new SyntaxError("Expected identifier after keyword global");return{kind:n.NodeType.Global,symbol:this.eat().raw};case o.TokenType.TARGET:return this.eat(),{kind:n.NodeType.Target};case o.TokenType.NUMBER:return{kind:n.NodeType.PrimitiveLiteral,value:Number(this.eat().raw)};case o.TokenType.STRING:return{kind:n.NodeType.PrimitiveLiteral,value:this.eat().raw};case o.TokenType.TRUE:return this.eat(),{kind:n.NodeType.PrimitiveLiteral,value:!0};case o.TokenType.FALSE:return this.eat(),{kind:n.NodeType.PrimitiveLiteral,value:!1};case o.TokenType.NULL:return this.eat(),{kind:n.NodeType.PrimitiveLiteral,value:null};case o.TokenType.OPEN_PAREN:{this.eat();const e=this.parse_expr();return this.expect(o.TokenType.CLOSE_PAREN),e}case o.TokenType.FUNCTION:return this.parse_function();case o.TokenType.STRUCT:return this.parse_struct();case o.TokenType.INLINE:return this.parse_inline();case o.TokenType.RESERVED:throw new SyntaxError(`Unexpected reserved word or symbol ${this.at().raw}`);default:throw new SyntaxError(`Invalid or unexpected token ${o.TokenType[e]}.`)}}}},134:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._globalEnv=t.VariablePool=t.OutputType=void 0;const n=r(19);var o;!function(e){e[e.TYPE_NUMBER=0]="TYPE_NUMBER",e[e.TYPE_STRING=1]="TYPE_STRING",e[e.TYPE_BOOLEAN=2]="TYPE_BOOLEAN",e[e.TYPE_UNKNOWN=3]="TYPE_UNKNOWN"}(o||(t.OutputType=o={}));class s{src;type;isAlwaysNumber(){return this.type===o.TYPE_NUMBER}isAlwaysString(){return this.type===o.TYPE_STRING}asNumber(){return this.isAlwaysNumber()?this.src:`Number(${this.src})`}asString(){return this.isAlwaysString()?this.src:`String(${this.src})`}asBoolean(){return`((${this.src} ?? false) === false)`}asUnknown(){return`(${this.src} ?? null)`}asIdent(){return`(${this.src})`}constructor(e,t){this.src=e,this.type=t}}class i{constantValue;constructor(e){this.constantValue=e}isAlwaysNumber(){return"number"==typeof this.constantValue}isAlwaysString(){return"string"==typeof this.constantValue}asNumber(){return this.isAlwaysNumber()?this.constantValue.toString():Number(this.constantValue).toString()}asString(){return this.isAlwaysString()?JSON.stringify(this.constantValue):JSON.stringify(this.constantValue.toString())}asBoolean(){return"boolean"==typeof this.constantValue?this.constantValue.toString():(!1===(this.constantValue??!1)).toString()}asUnknown(){switch(typeof this.constantValue){case"number":return this.asNumber();case"boolean":return this.asBoolean();case"object":if(this.constantValue)throw new Error("Unexpected Object.");return"null";default:return this.asString()}}asIdent(){return"(null)"}}function*a(e){let t=0;for(;;)yield e+t++}t.VariablePool=a;const p=a("s");t._globalEnv={__env:new Map,__readonly:new Map,makeReadOnly:function(e){return this.__readonly.set(e,!0)},readOnly:function(e){return this.__readonly.get(e)},set:function(e,t){if(this.__readonly.get(e))throw new TypeError("Attempted to overwrite read-only global");return this.__env.set(e,t),t},remove:function(e){if(this.__readonly.get(e))throw new TypeError("Attempted to remove read-only global");return this.__env.delete(e)},get:function(e){return this.__env.get(e)??(this.__env.set(e,{value:null}),this.__env.get(e))}};const u=function*(){}.constructor;class c{static CompilerSettings={referenceErrors:!0,debug:new URL(document.location.toString()).searchParams.has("psdebug")};program;src="let _;let _2;let _3;let _4;let _5; let _6; let _7;";scriptName;_variablePool;_cachedVariables;static _globalEnv=t._globalEnv;warpTimer;isWarp;yields;constructor(e){this.program=e,this.scriptName=p.next().value,this._variablePool=a("v"),this._cachedVariables={__proto__:null}}transpile(e,t,r,n){const o=this.program;this.warpTimer=r,this.isWarp=n,this.yields=t;for(const e of o.body)this.descendNode(e);switch(this.src=`try{${this.src}}catch(error){if(error?.isExit)return error?.returnValue;if(error instanceof Error){error.name = "(PenguinScript Evaluation) " + error.name};throw error};`,e){case"string":return this.src;case"func":try{return new Function("$globalEnv","util",this.src)}catch(e){throw e instanceof Error&&(e.name="(PenguinScript Transpilation Error)"+e.name),e}case"generator":try{return new u("$globalEnv","util",this.src)}catch(e){throw e instanceof Error&&(e.name="(PenguinScript Transpilation Error)"+e.name),e}}}yielded(){if(!this.yields)throw new Error("Script yielded but is not marked as yielding")}yieldLoop(){this.yields&&(this.warpTimer?(this.isWarp?this.src+="if (util.isStuck()) yield;":this.src+="yield;",this.yielded()):this.isWarp||(this.src+="yield;",this.yielded()))}getVariable(e){if(this._cachedVariables[e])return this._cachedVariables[e];const t=this._variablePool.next().value;return this._cachedVariables[e]=t}descendNode(e){switch(e.kind){case n.NodeType.NoOp:this.src+="/* NoOp Semicolon */;/* End NoOp Semicolon */";break;case n.NodeType.StmtBlock:{const t=e;this.src+="/* Statement Block */{";for(const e of t.body)this.descendNode(e);this.src+="}/* End Statement Block */";break}case n.NodeType.ReturnStatement:{const t=e;this.src+="/* Return Statement */return(",this.src+=this.descendExpr(t.value).asUnknown(),this.src+=")",this.src+="?? null;/* End Return Statement */";break}case n.NodeType.IfStatement:{const t=e;if(this.src+="/* If/Else Statement */if(",this.src+=this.descendExpr(t.condition).asBoolean(),this.src+=")",t.body.kind===n.NodeType.VariableDeclaration)throw new SyntaxError("Cannot declare a variable in a single-statement context");if(this.descendNode(t.body),t.else){if(this.src+="else ",t.else.body.kind===n.NodeType.VariableDeclaration)throw new SyntaxError("Cannot declare a variable in a single-statement context");this.descendNode(t.else.body)}this.src+=";/* End If/Else Statement */";break}case n.NodeType.VariableDeclaration:{const t=e,r=this.getVariable(t.symbol);if(t.constant?this.src+=`/* Constant Declaration (var: ${this.getVariable(t.symbol)}) */const `:this.src+="/* Variable Declaration (var: ${this.getVariable(node2.symbol)}) */const ",this.src+=r,t.value&&!t.constant){const e=this.descendExpr(t.value);this.src+="=",this.src+="{value:",this.src+=e.asUnknown(),this.src+="}"}if(t.value&&t.constant){const e=this.descendExpr(t.value);this.src+="=",this.src+='(function(v){return {get value(){return v},set value(v){throw new TypeError("Cannot reassign to a constant")}}})(',this.src+=e.asUnknown(),this.src+=")"}this.src+=";/* End Constant/Variable Declaration */";break}case n.NodeType.While:{const t=e;if(this.src+="/* While/RepeatUntil/Forever Loop */while(",this.src+=this.descendExpr(t.condition).asBoolean(),this.src+="){",t.body.kind===n.NodeType.VariableDeclaration)throw new SyntaxError("Cannot declare a variable in a single-statement context");this.descendNode(t.body),this.yieldLoop(),this.src+="};/* End While/RepeatUntil/Forever Loop */";break}case n.NodeType.Break:this.src+="/* Break Statement*/break;/* End Break Statement */";break;case n.NodeType.Continue:this.src+="/* Continue Statement */continue;/* End Continue Statement */";break;case n.NodeType.Try:{const t=e;this.src+=`/* Try/Catch/Finally Statement (var: ${t.catchVar?this.getVariable(t.catchVar):"No Var"}})*/try{`,this.descendNode(t.body),this.src+="}",t.catch&&(this.src+=`catch(catchErrorVar){if(catchErrorVar?.isExit)throw catchErrorVar;const ${this.getVariable(t.catchVar)||"thisShouldntHappen"} = {value: util.createError(util, catchErrorVar).next().value};`,this.descendNode(t.catch),this.src+="}"),t.finally&&(this.src+="finally{",this.descendNode(t.finally),this.src+="}"),this.src+=";/* End Try/Catch/Finally Statement */";break}default:{const t=this.descendExpr(e);this.src+=t.asUnknown(),this.src+=";"}}}descendExpr(e){switch(e.kind){case n.NodeType.Global:{const t=e;return new s(`/* Global (var: ${t.symbol}) */($globalEnv.get(${JSON.stringify(t.symbol)}).value)/* End Global */`,o.TYPE_UNKNOWN)}case n.NodeType.AssignmentExpr:{const t=e;if(t.assigne.kind!==n.NodeType.Identifier&&t.assigne.kind!==n.NodeType.Global&&t.assigne.kind!==n.NodeType.Chaining)throw new SyntaxError("Invalid left-hand in assignment");const r=this.descendExpr(t.assigne),i=this.descendExpr(t.value);return new s(`/* Assignment Expression */((${r.asIdent()}) = (${i.asUnknown()}))/* End Assignment Expression */`,o.TYPE_UNKNOWN)}case n.NodeType.UnaryExpr:{const t=e,r=this.descendExpr(t.operand);if("not"===t.operator)return new s(`/* Unary Expression */(!(${r.asBoolean()}))/* End Unary Expression */`,o.TYPE_BOOLEAN);if("-"===t.operator)return new s(`/* Unary Expression */yield* util.negate(${r.asUnknown()})/* End Unary Expression */`,o.TYPE_NUMBER);throw new SyntaxError("Unknown unary operator")}case n.NodeType.BinaryExpr:{const t=e;switch(t.operator){case"and":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(_ = ${e.asUnknown()}, _2 = ${r.asUnknown()}, (((_ ?? false) === false) && !((_2 ?? false) === false)) ? _ : _2)/* End Binary Expression */`,o.TYPE_UNKNOWN)}case"xor":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(_ = ${e.asUnknown()}, _2 = ${r.asUnknown()}, (((_ ?? false) === false) && !((_2 ?? false) === false)) ? _2 : (((_2 ?? false) === false) && !((_ ?? false) === false)) ? _ : (!((_2 ?? false) === false) && !((_ ?? false) === false)) ? false : _2)/* End Binary Expression */`,o.TYPE_UNKNOWN)}case"or":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(_ = ${e.asUnknown()}, _2 = ${r.asUnknown()}, (!((_ ?? false) === false) ? _ : _2))/* End Binary Expression */`,o.TYPE_UNKNOWN)}case"<":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.lt(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_BOOLEAN)}case">":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`(/* Binary Expression */(yield* util.gt(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_BOOLEAN)}case"<=":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.le(${e.asUnknown()}, ${r.asUnknown()})/* End Binary Expression */`,o.TYPE_BOOLEAN)}case">=":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.ge(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_BOOLEAN)}case"==":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.is(${e.asUnknown()}, ${r.asUnknown()})))/* End Binary Expression */`,o.TYPE_BOOLEAN)}case"+":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.add(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_NUMBER)}case"-":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.subtract(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_NUMBER)}case"*":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.multiply(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_NUMBER)}case"/":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.divide(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_NUMBER)}case"%":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.mod(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_NUMBER)}case"^":{const e=this.descendExpr(t.left),r=this.descendExpr(t.right);return new s(`/* Binary Expression */(yield* util.power(${e.asUnknown()}, ${r.asUnknown()}))/* End Binary Expression */`,o.TYPE_NUMBER)}}}case n.NodeType.PrimitiveLiteral:{const t=e.value;return new i(t)}case n.NodeType.Object:{const t=e,r=["util"];for(const e of t.body)r.push(this.descendExpr(e[0]).asUnknown()),r.push(this.descendExpr(e[1]).asUnknown());return new s(`/* Object */yield* util.createObject(${r.join(",")})/* End Object */`,o.TYPE_UNKNOWN)}case n.NodeType.Array:{const t=e,r=["util"];for(const e of t.body)r.push(this.descendExpr(e).asUnknown());return new s(`/* Array */yield* util.createObject(${r.join(",")})/* End Array */`,o.TYPE_UNKNOWN)}case n.NodeType.Complex:{const t=e,r=t.re?this.descendExpr(t.re).asUnknown()+",":"",n=t.im?this.descendExpr(t.im).asUnknown():"";return new s(`/* Complex */yield* util.createComplex(util, ${r}${n})/* End Complex */`,o.TYPE_UNKNOWN)}case n.NodeType.ErrorLiteral:{const t=e,r=t.msg?this.descendExpr(t.msg).asUnknown()+",":"",n=t.type?this.descendExpr(t.type).asUnknown():"";return new s(`/* Error */yield* util.createError(util, ${r}${n})/* End Error */`,o.TYPE_UNKNOWN)}case n.NodeType.Identifier:{const t=e,r=this.getVariable(t.symbol);let n;return n=c.CompilerSettings.referenceErrors?`;if(e instanceof ReferenceError){throw new ReferenceError("${r} is not defined.")};throw e;`:`;if(e instanceof ReferenceError){return {get value(){return null},set value(v){throw new ReferenceError("${r} is not defined.")}}};throw e;`,new s(`/* Identifier */(((function(){try{if(typeof ${r}!=="object"||${r}===globalThis.${r})throw new ReferenceError("");return ${r}}catch(e){${n}}})()).value)/* End Identifier */`,o.TYPE_UNKNOWN)}case n.NodeType.Inline:{const t=e;let r="";const n=this.src;this.src="",this.descendNode(t.body);const i=this.src;return this.src=n,this.yields?r+="(yield*(function*(){":r+="(function(){",r+=i,r+="})()",this.yields&&(r+=")"),new s(`/* Inline */(${r})/* End Inline */`,o.TYPE_UNKNOWN)}case n.NodeType.Function:{const t=e,r=t.args.args,n=this.src;this.src="",this.descendNode(t.body);const i=this.src;this.src=n;let a="";for(const e of r)a+=this.getVariable(e.symbol),a+=",";let p=t.symbol??"";return p&&(p=this.getVariable(t.symbol)),new s(`/* Function Expression */(function*${p}(unusedUtilVar,${a}){${i}})/* End Function Expression */`,o.TYPE_UNKNOWN)}case n.NodeType.FunctionCall:{const t=e,r=this.descendExpr(t.func).asUnknown(),n=[];for(const e of t.args)n.push(this.descendExpr(e).asUnknown());const i="(function(){debugger;})(),",a=`(_6 = ${r}, (function(){if(typeof _6 !== "function" || typeof _6().next !== "function")throw new TypeError("Cannot call non-function")})(), ((yield* _6(util,${n.join(",")})) ?? null))`;return new s(`/* Function Call */${c.CompilerSettings.debug?i:""}${a}/* End Function Call */`,o.TYPE_UNKNOWN)}case n.NodeType.Chaining:{const t=e,r=this.descendExpr(t.item).asUnknown(),n=`(function(){if(!(_3?.props&&_3?.isStruct))throw new TypeError("Can only use chaining operator on struct instances.");if(!_3.props[${JSON.stringify(t.index)}]){throw new TypeError("Struct does not have property, cannot chain.")};})()`,i="(function(){debugger;})(),";return new s(`/* Chaining */${c.CompilerSettings.debug?i:""}((_3 = ${r}, ${n}, _3).props[${JSON.stringify(t.index)}].value)/* End Chaining */`,o.TYPE_UNKNOWN)}case n.NodeType.In:{const t=e,r=this.descendExpr(t.item).asUnknown();return t.index,new s(`/* In Operator */(_5 = ${r}, _5 && _5.props && typeof _5 === "object" && _5.isStruct && typeof _5.props === "object" && ${JSON.stringify(t.index)} in _5.props)/* End In Operator */`,o.TYPE_UNKNOWN)}case n.NodeType.Ternary:{const t=e,r=this.descendExpr(t.body).asUnknown(),n=this.descendExpr(t.condition).asBoolean(),i=t.else?this.descendExpr(t.else).asUnknown():"(null)";return new s(`/* Ternary Operator */(${n} ? ${r} : ${i})/* End Ternary Operator */`,o.TYPE_UNKNOWN)}case n.NodeType.Struct:{const t=e;let r='(function*(){const struct = {__proto__: null,isStruct: true,props:{__proto__:null}};struct.toString=()=>"<PenguinScript Struct>"';for(const e of t.body){r+=`struct.props[${JSON.stringify(e[0])}]={value:`;let t="(null)";if(e[1]){const r=e[1];t=r.kind===n.NodeType.Function?`(function*(storedFunc){return function*(unusedUtilVar, ...args){return yield*(storedFunc)(unusedUtilVar, struct, ...args)}})(${this.descendExpr(r).src})`:this.descendExpr(r).asUnknown()}r+=`${t}};`}return r+="return struct;})",new s(`/* Struct */(${r})/* End Struct */`,o.TYPE_UNKNOWN)}case n.NodeType.Target:return new s("/* Target */(util.target)/* End Target */",o.TYPE_UNKNOWN)}}}t.default=c}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}var __webpack_exports__=__webpack_require__(156);return __webpack_exports__})()));
